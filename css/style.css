/* ===== BASE ===== */
:root{
  --bg:#0e0e12; --text:#f5f5f7; --muted:#cdd0d6;
  --panel:#1b1b23; --panel-2:#22222c;
  --accent:#cf899b;
  --danger:#ff6b6b; --gold:#ffcc4d;
  --hud:#cf899b;
  --black:#000000;
}
*{box-sizing:border-box}
html,body{
  height:100%; margin:0; background:var(--bg); color:var(--text);
  font-family:"Delius", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}
button{
  cursor:pointer; border:0; border-radius:10px; padding:10px 14px;
  background:var(--accent); color:#fff; font-weight:700; transition:.2s;
}
button:hover{transform:translateY(-1px)}
button:disabled{opacity:.45; cursor:not-allowed; filter:grayscale(0.2)}
.primary{background:var(--accent); color:#fff}
.ghost{background:transparent;border:2px solid var(--accent); color:#fff}
.danger{background:linear-gradient(180deg, var(--danger), #e55353);color:#180808}
.btn-next{ font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
.btn-continue{ font-size:1.3em; padding:12px 18px; }

/* ===== FRAME ===== */
#frame{
  position:relative; width:min(1280px,100vw); aspect-ratio:16/9; margin:10px auto 24px;
  background:#111; border:1px solid #2a2a36; border-radius:16px; overflow:hidden; box-shadow:0 10px 40px rgba(0,0,0,.55);
}

/* ===== HUD ===== */
#hud{ position:absolute; inset:0 0 auto 0; height:64px; display:flex; align-items:center; justify-content:space-between; padding:8px 10px; }
.hud-left{display:flex; gap:10px}
.hud-right{display:flex; gap:10px; background:var(--hud); padding:6px; border-radius:14px}
.hud-pill{
  display:flex; align-items:center; gap:8px; background:var(--hud);
  padding:8px 12px; border-radius:14px; color:#fff; font-weight:800; letter-spacing:.3px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.15), 0 1px 0 rgba(0,0,0,.25);
}
.hud-dia-label{opacity:.9; margin-right:2px}
.hud-btn{background:transparent; padding:6px 8px; border-radius:10px}
.hud-btn:hover{background:rgba(255,255,255,.15)}
.icon-24{width:24px; height:24px; filter: drop-shadow(0 1px 0 rgba(0,0,0,.3));}
.icon-28{width:28px; height:28px; filter: drop-shadow(0 1px 0 rgba(0,0,0,.3));}
#scene{position:absolute; inset:64px 0 0 0;}

/* ===== TRANSIÇÃO ===== */
#transition{ pointer-events:none; position:absolute; inset:0; background:#000; opacity:0; }
.fade-in{ animation: fadeIn .5s forwards; } .fade-out{ animation: fadeOut .5s forwards; }
@keyframes fadeIn{ from{opacity:0} to{opacity:1} } @keyframes fadeOut{ from{opacity:1} to{opacity:0} }

/* ===== TOAST ===== */
#toast{
  position:absolute; left:50%; bottom:16px; transform:translateX(-50%);
  background:rgba(0,0,0,.75); border:1px solid rgba(255,255,255,.1);
  padding:10px 14px; border-radius:10px; display:none;
  font-size:1.3rem;
}

/* ===== CASA ===== */
.scene-home{ position:absolute; inset:0; background:#222 url("../files/bg_casa.png") center/cover no-repeat; }
.home-overlay{position:absolute; inset:0; background:linear-gradient(180deg, rgba(0,0,0,.0), rgba(0,0,0,.25) 50%, rgba(0,0,0,.5) 100%)}

/* Botão Dormir */
.sleep-btn{
  position:absolute; top:20px; left:12px; z-index:3;
  background:var(--accent); color:#fff; border-radius:12px; padding:10px 14px; font-weight:800;
  box-shadow:0 6px 20px rgba(0,0,0,.25); display:flex; align-items:center; gap:8px;
}
.sleep-btn img{ width:24px; height:24px; display:block; }

/* ===== DIALOGUE (VN) ===== */
.scene-dialogue{
  position:absolute; inset:0;
  display:flex; flex-direction:column; justify-content:flex-end; padding:24px;
}
.vn-characters{position:absolute; inset:0; pointer-events:none; overflow:visible;}
.char{
  position:absolute; bottom:-30%; max-height:100%; filter: drop-shadow(0 12px 20px rgba(0,0,0,.45));
  opacity:0; --x:0; --scale:1.215; transform-origin: bottom center;
  transform: translate(var(--x), 20px) scale(var(--scale));
  transition: opacity .35s ease, transform .35s ease;
}
.char.left{left:calc(3% + 120px); --x:0}
.char.center{left:50%; --x:-50%}
.char.right{right:calc(3% + 120px); --x:0}
.char.show{opacity:1; transform: translate(var(--x), 0) scale(var(--scale))}
.char.hide{opacity:0; transform: translate(var(--x), 20px) scale(var(--scale))}

.box{ background:rgba(20,20,26,.88); border:1px solid rgba(255,255,255,.08); padding:18px; border-radius:14px; color:var(--text); backdrop-filter: blur(6px); }
.vn-box{display:grid; gap:10px; font-size:1.35rem; line-height:1.55}
.speaker{font-weight:900; color:#fff; text-shadow:0 1px 0 rgba(0,0,0,.4); font-size:1.45rem; text-align:left;}
.speaker.me{ text-align:right; }
.vn-text{ text-align:left; }
.vn-text.me{ text-align:right; }

.choices{
  display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:6px;
}
.choice{
  text-align:center; padding:12px 14px; border-radius:12px;
  background:rgba(0,0,0,.35); border:2px solid var(--accent); color:#fff;
}
.choice:hover{ filter:brightness(1.07); transform:translateY(-1px) }

.vn-controls{display:flex; gap:10px; justify-content:flex-end; margin-top:8px}

/* Phone overlay (home) — transparente para sobrepor o BG da casa */
.phone-overlay{
  position:absolute; inset:0;
  background: url("../files/handphone.png") center/cover no-repeat;
  pointer-events:none; opacity:0; transform:translateY(40px);
}
.phone-in{ animation: phoneIn .35s ease-out forwards; }
.phone-out{ animation: phoneOut .35s ease-in forwards; }
@keyframes phoneIn{ from{ transform:translateY(40px); opacity:0 } to{ transform:translateY(0); opacity:1 } }
@keyframes phoneOut{ from{ transform:translateY(0); opacity:1 } to{ transform:translateY(40px); opacity:0 } }

/* ===== MINIGAME ===== */
.scene-minigame{
  position:absolute; inset:0; background:#111 url("../files/bg_city.jpg") center/cover no-repeat;
  display:grid; grid-template-rows: 1fr 200px; gap:0;
}

/* camada de noite para crossfade */
.mg-sky-night{
  position:absolute; inset:0; z-index:0;
  background: url("../files/bg_city_night.jpg") center/cover no-repeat;
  opacity:0; pointer-events:none;
}
/* garantir clientes/mesa acima do overlay */
.mg-customers, .mg-table { position:relative; z-index:1; }

.mg-customers{
  position:relative; overflow:hidden; display:grid; grid-template-columns: repeat(3, 1fr);
  align-items:end; padding:0 30px 20px 30px; gap:12px;
}
.customer{
  position:relative; height:100%; display:flex; align-items:flex-end; justify-content:center;
  filter: drop-shadow(0 10px 16px rgba(0,0,0,.5));
  transform:translateY(40px); opacity:0;
}
.customer img{ max-height:95%; object-fit:contain; pointer-events:none; transform:scale(0.9); }

.order{
  position:absolute; top:8%; right:calc(10% + 5px);
  background:rgba(255,255,255,.8); color:#000;
  border:1px solid rgba(0,0,0,.2);
  padding:14px 16px; border-radius:16px;
  display:flex; align-items:center; justify-content:center; gap:10px;
  min-width:88px; min-height:88px; box-shadow:0 2px 8px rgba(0,0,0,.12);
}
.order img{ width:56px; height:56px; display:block; }

.customer img.shake{ animation:shake .35s }
@keyframes shake{
  0%{transform:translateX(0) scale(0.9)} 25%{transform:translateX(-8px) scale(0.9)}
  50%{transform:translateX(8px) scale(0.9)} 75%{transform:translateX(-5px) scale(0.9)} 100%{transform:translateX(0) scale(0.9)}
}

.enter-down-up{ animation: enterUp .35s ease-out forwards; }
.exit-up-down{ animation: exitDown .35s ease-in forwards; }
@keyframes enterUp{ from{ transform:translateY(40px); opacity:0 } to{ transform:translateY(0); opacity:1 } }
@keyframes exitDown{ from{ transform:translateY(0); opacity:1 } to{ transform:translateY(40px); opacity:0 } }

.mg-table{ position:relative; background: url("../files/table.png") center 45% / cover no-repeat; }
.items{ position:absolute; left:0; right:0; top:0; bottom:0; display:flex; gap:24px; align-items:flex-end; justify-content:center; padding-bottom:36px; }
.item{ position:absolute; width:150px; height:150px; user-select:none; touch-action:none; display:grid; place-items:center; }
.item .plate{ position:absolute; inset:0; background:url("../files/plate.png") center/contain no-repeat; pointer-events:none; }
.item .food{ position:absolute; inset:20px; background-position:center; background-repeat:no-repeat; background-size:contain; pointer-events:none; }
.dragging{ transform:scale(1.05); z-index:5; filter:drop-shadow(0 12px 24px rgba(0,0,0,.5)); }

.mg-hud{ position:absolute; top:8px; left:50%; transform:translateX(-50%); display:flex; align-items:center; gap:10px; z-index:5; }
.mg-pill{ display:flex; align-items:center; gap:8px; background:rgba(0,0,0,.45); padding:8px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.12); }
.mg-icon{ width:24px; height:24px; }

.mg-pill-btn{
  display:flex; align-items:center; gap:8px; background:rgba(0,0,0,.45);
  padding:8px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.12);
  color:#fff; box-shadow:none;
}
.mg-pill-btn:hover{ transform:none; filter:brightness(1.05) }
.mg-pill-btn img{ width:24px; height:24px; display:block; }

/* Painéis (start/end) — AGORA ACIMA DE TUDO */
.panel{
  position:absolute; left:50%; top:50%; transform:translate(-50%,-30%); min-width:340px;
  background:rgba(0,0,0,.8); border:1px solid rgba(255,255,255,.12); border-radius:14px;
  padding:18px; text-align:center; opacity:0; pointer-events:none;
  z-index:10; /* <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  garante que fique acima dos clientes/mesa/HUD */
}
.panel.show{ pointer-events:all; animation: panelIn .35s cubic-bezier(.2,.9,.2,1) forwards; }
@keyframes panelIn{ from{opacity:0; transform:translate(-50%,-10%)} to{opacity:1; transform:translate(-50%,-50%)} }

/* Util */
.hidden{display:none}
.center{text-align:center}
